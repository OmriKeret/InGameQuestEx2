// room script file

int timer = 64;
String time_As_string;
function Stick_Look()
{
  player.Say("This look like a strong wood stick.");
}

function playerDead() {
  player.Say("We are Too late!");
  Wait(20);
  player.ChangeRoom(5);
}

function Stick_Interact()
{

 player.Walk(Stick.X , Stick.Y, eBlock);
 player.AddInventory(iStick);
 Stick.Visible = false;
 player.Say("This look like a strong wood stick ");
}

function room_FirstLoad()
{

}

function repeatedly_execute_always()
{
  
  if(IsTimerExpired(9)) {
    aPistolFire.Play();
  }
   if(IsTimerExpired(1)){
     SetTimer(1, 40);
      TimerBackground.Visible = true;
      Timer.Visible = false;
      timer = timer - 1;
      
    oZombieClock.Visible = true;
    if (!oZombieClock.Animating) {
      oZombieClock.Animate(0, 40, eOnce, eNoBlock);
    }
   }
   if(IsTimerExpired(2) && !samIsDead) {
     String samBegging[3];
     samBegging[0] = "Please.. you dont have to do this!";
     samBegging[1] = "Please.. I don't want to die!";
     samBegging[2] = "Please don't";
     SetTimer(2, 400);
     SetTimer(3, 200);
     cSam.SayBackground(samBegging[Random(2)]);
   }
   if(IsTimerExpired(3))
   {
     cNick.SayBackground("Shoot her already, they are coming!");
   }
      if(IsTimerExpired(4))
   {
     cSam.SayBackground("AHH...");
     SetTimer(4, 200);
   }
   if(timer < 64) 
   {
     //time_As_string = String.Format("%d", timer);
     
    // Timer.Text = time_As_string;
     if( timer == 0)
     {
       //what happens if you are dead?
         playerDead();
     }
   }
   
   if(!TimerBackground.Visible) {
     oZombieClock.Visible = false;
   }
   


}


function cStickOnTree_UseInv()
{
  if(player.ActiveInventory == iKnife && !decidedToKillSam) 
  {
    player.Walk(304, 498, eBlock);
    cStickOnTree.Visible = false;
    Stick.Visible = true;
    Display("The stick fell on the ground"); 
  }
  else 
  {
    player.Think("I don't need this stick");
  }
}

function cStickOnTree_Look()
{
  player.FaceObject(cStickOnTree);
  player.Think("Looks like a strong stick");
}

function cVine_Look()
{
  player.FaceObject(cVine);
  player.Think("Looks like a strong vine");
}

function cVine_UseInv()
{
  if(player.ActiveInventory == iKnife && !decidedToKillSam) 
  {
    player.Walk(470, 496, eBlock);
    cVine.Visible = false;
    player.Think("I might be able to use this");
    player.AddInventory(iVine);
  }
  else 
  {
    player.Think("I don't need this vine");
  }
}

function room_LeaveLeft()
{ 
if(cOscar.x < 300 && cNick.x < 300 ) {
   player.ChangeRoom(3, 555, 666);
  }
}

function cStickOnTree_Interact()
{
  player.Walk(304, 498, eBlock);
  player.Think("I can't pull this off. I need to cut it");
}

function cVine_Interact()
{
  player.Walk(470, 496, eBlock);
  player.Think("I can't pull this off. I need to cut it");
}

function room_Load()
{
      aUndeadHighTension1.Play();
 gMainMenu.Visible = false;
gMenuSlider.Visible = true;
gIconbar.Visible = true;
oZombieClock.SetView(6, 0, 0);
    player.x = 488;
    player.y = 604;
    cNick.ChangeRoom(2);
    cNick.x = 304;
    cNick.y = 544;
    cOscar.ChangeRoom(2);
    cOscar.x =640 ;
    cOscar.y = 517;
    cSam.ChangeRoom(2);
    cSam.x =878 ;
    cSam.y = 551;
}

function room_RepExec()
{
}

function room_AfterFadeIn()
{
  PlayerRoom = 2;
dOpeneingSamCry.Start();  
}

function room_Leave()
{
 aUndeadHighTension1.Stop();
}

function hTree_Look()
{
  if(player.HasInventory(iStick)|| player.HasInventory(iStickVine) || decidedToKillSam) {
    player.Think("It looks like an old tree");
  } else if(!decidedToKillSam && !player.HasInventory(iStick) ) {
    player.Think("Maybe I could use this stick");
  } else if(!decidedToKillSam && !player.HasInventory(iVine) ) {
    player.Think("Maybe I could use this vine");
  }
}

function hOldCar_Look()
{
 player.Think("This piece of junk won't help me");
}
